---
import BlogCard from '../../../../components/BlogCard.astro'; // Adjust path if needed

const PAGE_SIZE = 20;
const { page } = Astro.params;
const currentPage = parseInt(page || '1');

const res = await fetch('/JSON/custom-ml-blog-posts.json');
const allPosts = await res.json();

const totalPages = Math.ceil(allPosts.length / PAGE_SIZE);
const start = (currentPage - 1) * PAGE_SIZE;
const end = start + PAGE_SIZE;
const posts = allPosts.slice(start, end);
---

<section class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
  {posts.map(post => (
    <BlogCard blog_data={post} />
  ))}
</section>

<!-- Your custom pagination -->
<nav aria-label="Page navigation example" class="mt-10">
  <ul class="flex items-center justify-center gap-1">
    <li>
      <a href={`/services/custom-ml/blog/${currentPage - 1}`} class="pagination-link">
        ← Prev
      </a>
    </li>

    {Array.from({ length: totalPages }, (_, i) => (
      <li>
        <a
          href={`/services/custom-ml/blog/${i + 1}`}
          class={`px-3 py-1 border ${
            currentPage === i + 1 ? 'bg-blue-600 text-white' : 'bg-white text-gray-700'
          }`}
        >
          {i + 1}
        </a>
      </li>
    ))}

    <li>
      <a href={`/services/custom-ml/blog/${currentPage + 1}`} class="pagination-link">
        Next →
      </a>
    </li>
  </ul>
</nav>